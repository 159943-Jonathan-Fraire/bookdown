<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Yihui Xie" />

<meta name="date" content="2016-01-13" />

  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<title>Authoring A Book with R Markdown and bookdown</title>

<script src="libs/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.1/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.1/shim/respond.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-4 well">
<div id="TOC">
<ul>
<li><a href="index.html#introduction"><span class="toc-section-number">1</span> Introduction</a><ul>
<li><a href="index.html#motivation"><span class="toc-section-number">1.1</span> Motivation</a></li>
<li><a href="index.html#get-started"><span class="toc-section-number">1.2</span> Get started</a></li>
<li><a href="index.html#usage"><span class="toc-section-number">1.3</span> Usage</a></li>
<li><a href="index.html#some-tips"><span class="toc-section-number">1.4</span> Some tips</a></li>
</ul></li>
<li><a href="01-components.html#components"><span class="toc-section-number">2</span> Components</a><ul>
<li><a href="01-components.html#markdown-syntax"><span class="toc-section-number">2.1</span> Markdown syntax</a></li>
<li><a href="01-components.html#r-code"><span class="toc-section-number">2.2</span> R code</a></li>
<li><a href="01-components.html#figures"><span class="toc-section-number">2.3</span> Figures</a></li>
<li><a href="01-components.html#tables"><span class="toc-section-number">2.4</span> Tables</a></li>
<li><a href="01-components.html#cross-references"><span class="toc-section-number">2.5</span> Cross-references</a></li>
<li><a href="01-components.html#custom-blocks"><span class="toc-section-number">2.6</span> Custom blocks</a></li>
<li><a href="01-components.html#citations"><span class="toc-section-number">2.7</span> Citations</a></li>
<li><a href="01-components.html#interactive-shiny-apps"><span class="toc-section-number">2.8</span> Interactive Shiny apps</a></li>
</ul></li>
<li><a href="02-formats.html#output-formats"><span class="toc-section-number">3</span> Output Formats</a><ul>
<li><a href="02-formats.html#html"><span class="toc-section-number">3.1</span> HTML</a></li>
<li><a href="02-formats.html#latex"><span class="toc-section-number">3.2</span> LaTeX</a></li>
<li><a href="02-formats.html#e-books"><span class="toc-section-number">3.3</span> E-Books</a></li>
</ul></li>
<li><a href="03-customization.html#customization"><span class="toc-section-number">4</span> Customization</a><ul>
<li><a href="03-customization.html#yaml-options"><span class="toc-section-number">4.1</span> YAML options</a></li>
<li><a href="03-customization.html#theming"><span class="toc-section-number">4.2</span> Theming</a></li>
<li><a href="03-customization.html#templates"><span class="toc-section-number">4.3</span> Templates</a></li>
<li><a href="03-customization.html#cjk-languages"><span class="toc-section-number">4.4</span> CJK languages</a></li>
</ul></li>
<li><a href="04-editors.html#editors"><span class="toc-section-number">5</span> Editors</a><ul>
<li><a href="04-editors.html#rstudio"><span class="toc-section-number">5.1</span> RStudio</a></li>
</ul></li>
<li><a href="05-publishing.html#publishing"><span class="toc-section-number">6</span> Publishing</a><ul>
<li><a href="05-publishing.html#github"><span class="toc-section-number">6.1</span> GitHub</a></li>
<li><a href="05-publishing.html#publishers"><span class="toc-section-number">6.2</span> Publishers</a></li>
<li><a href="05-publishing.html#licensing"><span class="toc-section-number">6.3</span> Licensing</a></li>
<li><a href="05-publishing.html#self-publishing"><span class="toc-section-number">6.4</span> Self-publishing</a></li>
</ul></li>
<li><a href="06-references.html#references">References</a></li>
</ul>
</div>
</div>
<div class="col-sm-8">
<div id="header">
<h1 class="title">Authoring A Book with R Markdown and bookdown</h1>
<h4 class="author"><em>Yihui Xie</em></h4>
<h4 class="date"><em>2016-01-13</em></h4>
</div>
<div id="introduction" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Introduction</h1>
<div class="rmdwarning">
<p>
This book and the package <strong>bookdown</strong> are still under active development, and should not be considered stable at the moment. You are welcome to experiment with this package, and feedback may be sent to
<script type="text/javascript">
<!--
h='&#114;&#x73;&#116;&#x75;&#100;&#x69;&#x6f;&#46;&#x63;&#x6f;&#x6d;';a='&#64;';n='&#x79;&#x69;&#104;&#x75;&#x69;';e=n+a+h;
document.write('<a h'+'ref'+'="ma'+'ilto'+':'+e+'" clas'+'s="em' + 'ail">'+e+'<\/'+'a'+'>');
// -->
</script>
<noscript>
yihui at rstudio dot com
</noscript>
.
</p>
</div>
<p>This book is a guide to authoring books with R Markdown <span class="citation">(Allaire et al. <a href="06-references.html#ref-R-rmarkdown">2015</a>)</span> and the R package <strong>bookdown</strong> <span class="citation">(Xie <a href="06-references.html#ref-R-bookdown">2016</a><a href="06-references.html#ref-R-bookdown">a</a>)</span>. It focuses on the features specific to writing books, long-form articles, or reports, such as</p>
<ul>
<li>How to typeset figures and tables, and cross-reference them;</li>
<li>How to generate multiple output formats such as HTML, PDF, and E-Books for a single book;</li>
<li>How to customize the book templates and style different elements in a book;</li>
<li>The editor support (in particular, the RStudio IDE);</li>
<li>How to publish a book;</li>
</ul>
<p>It is not a comprehensive introduction to R Markdown or the <strong>knitr</strong> package <span class="citation">(Xie <a href="06-references.html#ref-R-knitr">2016</a><a href="06-references.html#ref-R-knitr">b</a>)</span>, on top of which <strong>bookdown</strong> was built. To learn more about R Markdown, please check out the online documentation <a href="http://rmarkdown.rstudio.com" class="uri">http://rmarkdown.rstudio.com</a>. For <strong>knitr</strong>, please see <span class="citation">Xie (<a href="06-references.html#ref-xie2015">2015</a>)</span>. You do not have to be an expert of the R language <span class="citation">(R Core Team <a href="06-references.html#ref-R-base">2015</a>)</span> to read this book, but you are expected to have some basic knowledge about R Markdown and <strong>knitr</strong>. For beginners, you may get started with the cheetsheets at <a href="https://www.rstudio.com/resources/cheatsheets/" class="uri">https://www.rstudio.com/resources/cheatsheets/</a>. To be able to customize the book templates and themes, you should be familiar with LaTeX, HTML and CSS.</p>
<div id="motivation" class="section level2">
<h2><span class="header-section-number">1.1</span> Motivation</h2>
<p>Markdown is a wonderful language to write relatively simple documents that contain elements like sections, paragraphs, lists, links, and images, etc. Pandoc (<a href="http://pandoc.org" class="uri">http://pandoc.org</a>) has greatly extended the original Markdown syntax, and added quite a few useful new features, such as footnotes, citations, and tables. More importantly, Pandoc makes it possible to generate output documents of a large variety of formats from Markdown, including HTML, LaTeX/PDF, Word, and slides.</p>
<p>To write a relatively complicated document like a book, there are still a few useful features missing in Pandoc’s Markdown at the moment, such as automatic numbering of figures and tables in the HTML output, cross-references of figures and tables, and fine control of the appearance of figures (e.g., currently it is impossible to specify the width of images using the Markdown syntax). These are some of the problems that we have addressed in the <strong>bookdown</strong> package.</p>
<p>Under the constraint that we want to produce the book in multiple output formats, it is nearly impossible to cover all possible features specific to these output formats. For example, it may be difficult to reinvent a certain complicated LaTeX environment in the HTML output using the (R) Markdown syntax. Our main goal is not to replace <em>everything</em> with Markdown, but to cover <em>most</em> common functionalities required to write a relatively complicated document, and make the syntax of such functionalities consistent across all output formats.</p>
<p>Another goal of this project is to make it easy to produce books that look visually pleasant. Some nice existing examples include Gitbook (<a href="https://www.gitbook.com" class="uri">https://www.gitbook.com</a>), Tufte CSS (<a href="http://edwardtufte.github.io/tufte-css/" class="uri">http://edwardtufte.github.io/tufte-css/</a>), and Tufte-LaTeX (<a href="https://tufte-latex.github.io/tufte-latex/" class="uri">https://tufte-latex.github.io/tufte-latex/</a>). We hope to integrate these themes and styles into <strong>bookdown</strong>, so authors do not have to dive into the details of how to use a certain LaTeX class or how to configure CSS for HTML output.</p>
</div>
<div id="get-started" class="section level2">
<h2><span class="header-section-number">1.2</span> Get started</h2>
<p>The easiest way for beginners to get started with writing a book with R Markdown and <strong>bookdown</strong> is through the demo <code>bookdown-demo</code> on GitHub:</p>
<ol style="list-style-type: decimal">
<li>Fork or clone the GitHub repository <a href="https://github.com/rstudio/bookdown-demo" class="uri">https://github.com/rstudio/bookdown-demo</a> if you are familiar with GIT and GitHub, or just download it as a Zip file then unzip it locally;</li>
<li>Install the RStudio IDE (<a href="http://www.rstudio.com" class="uri">http://www.rstudio.com</a>) if you have not done so;</li>
<li>Open the <code>bookdown-demo</code> repository you cloned or downloaded in RStudio by clicking <code>bookdown-demo.Rproj</code>;</li>
<li><p>Install the R package <strong>bookdown</strong>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># TODO: remove yihui.name/xran here after bookdown is on CRAN</span>
<span class="kw">install.packages</span>(<span class="st">&quot;bookdown&quot;</span>, <span class="dt">repos =</span> <span class="kw">c</span>(<span class="st">&quot;http://yihui.name/xran&quot;</span>, <span class="st">&quot;http://cran.rstudio.com&quot;</span>))</code></pre></div></li>
<li><p>Open the R Markdown <code>index.Rmd</code> and click the button <code>Knit</code> on the toolbar of RStudio;</p></li>
</ol>
<p>Now you should see the index page of this book demo in the RStudio Viewer. You may add or change the R Markdown files, come back to <code>index.Rmd</code>, and hit the <code>Knit</code> button again to preview the book. If you prefer not to use RStudio, you may also compile the book through command line. See the next section for details.</p>
</div>
<div id="usage" class="section level2">
<h2><span class="header-section-number">1.3</span> Usage</h2>
<p>A book normally contains multiple chapters. We assume that one chapter lives in one R Markdown file (with the filename extension <code>.Rmd</code>). You should not have multiple chapters in one R Markdown file, or one chapter split into multiple R Markdown files. Each R Markdown file must start immediately with the chapter title. Here is an example (the bullets are the filenames, followed by the file content):</p>
<ul>
<li><p>01-intro.Rmd</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span class="fu"># Introduction</span>

This chapter is an overview of the methods that
we propose to solve an **important problem**.</code></pre></div></li>
<li><p>02-literature.Rmd</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span class="fu"># Literature</span>

Here is a review of existing methods.</code></pre></div></li>
<li><p>03-method.Rmd</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span class="fu"># Methods</span>

We describe our methods in this chapter.</code></pre></div></li>
<li><p>04-application.Rmd</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span class="fu"># Applications</span>

Some _significant_ applications are demonstrated
in this chapter.

<span class="fu">## Example one</span>

<span class="fu">## Example two</span></code></pre></div></li>
<li><p>05-summary.Rmd</p>
<div class="sourceCode"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span class="fu"># Final Words</span>

We have finished a nice book.</code></pre></div></li>
</ul>
<p>By default, <strong>bookdown</strong> merges all Rmd files by the order of filenames, e.g., <code>01-intro.Rmd</code> will appear before <code>02-literature.Rmd</code>. Filenames that start with an underscore <code>_</code> are skipped. If there exists an Rmd file named <code>index.Rmd</code>, it will always be treated as the first file when merging all Rmd files. The reason for this special treatment is that the HTML file <code>index.html</code> to be generated from <code>index.Rmd</code> is usually the default index file when you view a website, e.g., you are actually browsing <a href="http://yihui.name/index.html" class="uri">http://yihui.name/index.html</a> when you open <a href="http://yihui.name/" class="uri">http://yihui.name/</a>.</p>
<p>You can override the above behavior by including a configuration file named <code>_config.yml</code> in the book directory. It is a YAML file (<a href="https://en.wikipedia.org/wiki/YAML" class="uri">https://en.wikipedia.org/wiki/YAML</a>), and R Markdown users should be familiar with this format since it is also used to write the metadata in the beginning of R Markdown documents. You can use a field named <code>rmd_files</code> to define your own list and order of Rmd files for the book. For example,</p>
<div class="sourceCode"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span class="fu">rmd_files:</span> <span class="kw">[</span><span class="st">&quot;index.Rmd&quot;</span><span class="kw">,</span> <span class="st">&quot;abstract.Rmd&quot;</span><span class="kw">,</span> <span class="st">&quot;intro.Rmd&quot;</span><span class="kw">]</span></code></pre></div>
<p>In this case, <strong>bookdown</strong> will just use whatever you defined in this YAML field without any special treatments of <code>index.Rmd</code> or underscores. If you want both HTML and LaTeX/PDF output from the book, and use different Rmd files for HTML and LaTeX output, you may specify these files for the two output formats separately, e.g.,</p>
<div class="sourceCode"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span class="fu">rmd_files:</span>
  <span class="fu">html:</span> <span class="kw">[</span><span class="st">&quot;index.Rmd&quot;</span><span class="kw">,</span> <span class="st">&quot;abstract.Rmd&quot;</span><span class="kw">,</span> <span class="st">&quot;intro.Rmd&quot;</span><span class="kw">]</span>
  <span class="fu">latex:</span> <span class="kw">[</span><span class="st">&quot;abstract.Rmd&quot;</span><span class="kw">,</span> <span class="st">&quot;intro.Rmd&quot;</span><span class="kw">]</span></code></pre></div>
<div class="rmdimportant">
<p>
Because <strong>knitr</strong> does not allow duplicate chunk labels in a source document, you need to make sure there are no duplicate labels in your book chapters, otherwise <strong>knitr</strong> will signal an error when knitting the merged Rmd file.
</p>
</div>
<p>At the moment, there are two output formats that you may use: <code>bookdown::pdf_book</code> and <code>bookdown::html_chapters</code>. There is a <code>bookdown::render_book()</code> function similar to <code>rmarkdown::render()</code> that renders multiple Rmd documents into a book using the output format functions. You may either call this function from command line, or use it in the RStudio IDE. Here are some command line examples:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bookdown::<span class="kw">render_book</span>(<span class="st">&quot;foo.Rmd&quot;</span>, bookdown::<span class="kw">html_chapters</span>())
bookdown::<span class="kw">render_book</span>(<span class="st">&quot;foo.Rmd&quot;</span>, bookdown::<span class="kw">pdf_book</span>())
bookdown::<span class="kw">render_book</span>(<span class="st">&quot;foo.Rmd&quot;</span>, bookdown::<span class="kw">html_chapters</span>(<span class="dt">lib_dir =</span> <span class="st">&quot;book_assets&quot;</span>))
bookdown::<span class="kw">render_book</span>(<span class="st">&quot;foo.Rmd&quot;</span>, bookdown::<span class="kw">pdf_book</span>(<span class="dt">keep_tex =</span> <span class="ot">TRUE</span>))</code></pre></div>
<p>To use <code>render_book</code> and the output format functions in the RStudio IDE, you can define a YAML field named <code>knit</code> that takes the value <code>bookdown::render_book</code>, and the output format functions can be used in the <code>output</code> field, e.g.,</p>
<div class="sourceCode"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span class="ot">---</span>
<span class="fu">knit:</span> <span class="st">&quot;bookdown::render_book&quot;</span>
<span class="fu">output:</span>
  <span class="fu">bookdown:</span>:html_chapters:
    <span class="fu">lib_dir:</span> <span class="st">&quot;book_assets&quot;</span>
  <span class="fu">bookdown:</span>:pdf_book:
    <span class="fu">keep_tex:</span> yes
<span class="ot">---</span></code></pre></div>
<p>Then you can click the <code>Knit</code> button in RStudio to compile the Rmd files into a book.</p>
<p>There are more things you can configure for a book in <code>_config.yml</code>:</p>
<ul>
<li><code>main_rmd</code>: the filename of the main Rmd file, i.e., the Rmd file that is merged from all chapters; by default, it is named <code>_main.Rmd</code></li>
<li><code>chapter_name</code>: (for HTML output only) either a character string to be prepended to the chapter number in the chapter title (by default it is <code>&quot;Chapter &quot;</code>), or an R function that takes the chapter number as the input and returns a string as the new chapter number (e.g., <code>!expr function(i) paste('Chapter', i)</code>)</li>
<li><code>before_chapter_script</code>: one or multiple R scripts to be executed before each chapter, e.g., you may want to clear the workspace before compiling each chapter, in which case you can use <code>rm(list = ls(all = TRUE))</code> in the R script</li>
<li><code>after_chapter_script</code>: similar to <code>before_chapter_script</code>, and the R script is executed after each chapter</li>
</ul>
<p>Here is a sample <code>_config.yml</code>:</p>
<div class="sourceCode"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span class="fu">main_rmd:</span> <span class="st">&quot;my-book.Rmd&quot;</span>
<span class="fu">chapter_name:</span> <span class="st">&quot;CHAPTER &quot;</span>
<span class="fu">before_chapter_script:</span> <span class="kw">[</span><span class="st">&quot;script1.R&quot;</span><span class="kw">,</span> <span class="st">&quot;script2.R&quot;</span><span class="kw">]</span>
<span class="fu">after_chapter_script:</span> <span class="st">&quot;script3.R&quot;</span></code></pre></div>
</div>
<div id="some-tips" class="section level2">
<h2><span class="header-section-number">1.4</span> Some tips</h2>
<p>Typesetting under the paging constraint (e.g., for LaTeX/PDF output) can be an extremely tedious and time-consuming job. I’d recommend you not to look at your PDF output frequently, since most of the time you are very unlikely to be satisfied: text may overflow into the page margin, figures may float too far away, and so on. Do not try to make things look right <em>immediately</em>, because you may be disappointed over and over again as you keep on revising the book, and things may be messed up again even if you only did some minor changes (see <a href="http://bit.ly/tbrLtx" class="uri">http://bit.ly/tbrLtx</a> for a nice illustration).</p>
<p>If you want to preview the book, preview the HTML output. Work on the PDF book after you have finished the content of the book, and are very sure no major revisions will be required.</p>
<p>If certain code chunks in your R Markdown docuemnts are time-consuming to run, you may cache them by adding the chunk option <code>cache = TRUE</code> in the chunk header, and you are recommended to label such code chunks as well, e.g.,</p>
<pre><code>```{r important-computing, cache=TRUE}</code></pre>

</div>
</div>
<div style="text-align: center;">
<a href="#" class="btn btn-default" disabled>Previous</a>
<a href="01-components.html" class="btn btn-default">Next</a>
</div>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
